define state
    repeat
        sequence if: '${v:to_f} is not set'
            set 'v:to_f': 'state_matches'
        wait_for_node_state action: '$v:action', node_id: '$v:node_id', reachable: '$v:reachable', to_f: '$v:to_f'
        log message: 'wait_for_node_state result ${${v:to_f}}'
        break if: '${${v:to_f}} == true'
        wait for: '10s'
    unset 'v:to_f'
