definitions:

    ##################################################################################
    # Policies & rules definitions
    ##################################################################################
    policies:
        types:
            # $node_id will be injected with the current node id
            # $event will be injected with a json form event
            start_detection_policy: |
                (fn [event]
                    (let [ip-event (assoc event :host "$node_id"
                                                :service "ip"
                                                :state (get event :host)
                                                :description "$event"
                                                :tags ["cosmo"])]
                        (call-rescue ip-event [index]))
                    (let [reachable-event (assoc event :host "$node_id"
                                                       :service "reachable"
                                                       :state "true"
                                                       :description "$event"
                                                       :tags ["cosmo"])]
                        (call-rescue reachable-event [index])))

            failure_detection_policy: |
                12345676...

        rules:
            state_equals: |
                (service "${service}")
                (state "${state}")

            state_not_equals: |
                 (service "${service}")
                 (not (state "${state}"))

            metric_below: |
                 (service "${service}")
                 (< (metric "${metric}"))
